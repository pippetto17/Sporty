<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<BorderPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
            prefWidth="1000" prefHeight="750">

    <top>
        <VBox spacing="0">
            <!-- Header Superiore (Logo + Toggle + Utente) -->
            <HBox alignment="CENTER_LEFT" spacing="25" styleClass="header-container" style="-fx-border-color: -color-border-subtle; -fx-border-width: 0 0 1 0; -fx-padding: 25 40 25 40;">
                
                <Label text="SPORTY" styleClass="title-1, accent"/>

                <!-- Container per il Toggle Switch (popolato da Java) -->
                <HBox fx:id="roleSwitchContainer" alignment="CENTER_LEFT" spacing="10">
                    <padding><Insets left="30"/></padding>
                </HBox>

                <Region HBox.hgrow="ALWAYS"/>

                <HBox alignment="CENTER_RIGHT" spacing="20">
                    <VBox alignment="CENTER_RIGHT" spacing="4">
                        <Label fx:id="welcomeLabel" text="Welcome" styleClass="text-bold"/>
                        <Label fx:id="roleLabel" text="Player" styleClass="text-small, text-muted"/>
                    </VBox>
                    
                    <ImageView fx:id="userImageView" fitHeight="60" fitWidth="60" pickOnBounds="true" preserveRatio="true" smooth="true"/>
                    
                    <Button fx:id="logoutButton" text="Logout" onAction="#handleLogout"
                            styleClass="danger-button"/>
                </HBox>
            </HBox>

            <!-- Hero Section (Barra di Ricerca) -->
            <VBox fx:id="heroContainer" alignment="CENTER" style="-fx-padding: 30 0 30 0;">
                <!-- Il contenitore dei filtri verrÃ  iniettato qui da Java -->
                <VBox fx:id="filterContainer" alignment="CENTER" fillWidth="false" spacing="10">
                    <!-- Populated dynamically -->
                </VBox>
            </VBox>
        </VBox>
    </top>

    <center>
        <ScrollPane fx:id="mainScrollPane" fitToWidth="true" hbarPolicy="NEVER" style="-fx-background-color: transparent;">
            <VBox fx:id="mainContentBox" spacing="20">
                <padding>
                    <Insets top="10" right="40" bottom="40" left="40"/>
                </padding>

                <!-- Azioni Organizzatore (Visibile solo se Organizer) -->
                <VBox fx:id="organizerActionsBox" spacing="15" visible="false" managed="false">
                    <Label text="Quick Actions" styleClass="title-4"/>
                    <HBox spacing="15">
                        <Button fx:id="organizeMatchButton" text="+ Create Match"
                                onAction="#handleOrganizeMatch" styleClass="accent, large"
                                prefWidth="200" prefHeight="50"/>
                        <Button fx:id="bookFieldButton" text="Book Field"
                                onAction="#handleBookField" styleClass="button-outlined, large"
                                prefWidth="200" prefHeight="50"/>
                    </HBox>
                </VBox>

                <!-- Sezione Partite -->
                <VBox spacing="20">
                    <HBox alignment="CENTER_LEFT">
                        <Label fx:id="matchesTitle" text="Explore Matches" styleClass="title-4"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button fx:id="refreshButton" text="Refresh" onAction="#handleRefresh"
                                styleClass="flat, accent"/>
                    </HBox>

                    <!-- GRID VIEW (FlowPane) -->
                    <FlowPane fx:id="matchesContainer"
                              hgap="25" vgap="25" prefWrapLength="900" 
                              alignment="TOP_LEFT">
                        <!-- Le Match Cards verticali vengono aggiunte qui -->
                    </FlowPane>
                </VBox>
            </VBox>
        </ScrollPane>
    </center>

</BorderPane>