<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<BorderPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
            prefWidth="700" prefHeight="750">

    <top>
        <VBox spacing="10" styleClass="header-container" style="-fx-border-color: -color-border-subtle; -fx-border-width: 0 0 1 0;">
            <padding>
                <Insets top="20" right="30" bottom="15" left="30"/>
            </padding>

            <HBox alignment="CENTER_LEFT" spacing="15">
                <Label text="ðŸ“… ORGANIZE MATCH" styleClass="title-3, accent"/>

                <Region HBox.hgrow="ALWAYS"/>

                <Button fx:id="backButton" text="â†" onAction="#handleBack"
                       styleClass="secondary-button" prefWidth="50"/>
            </HBox>
        </VBox>
    </top>

    <center>
        <ScrollPane fitToWidth="true" styleClass="content-scroll">
            <VBox spacing="25" styleClass="form-container">
                <padding>
                    <Insets top="30" right="40" bottom="30" left="40"/>
                </padding>

                <VBox fx:id="inputContainer" spacing="25">
                    <!-- Sport Selection -->
                    <VBox spacing="8">
                        <Label text="Sport *" styleClass="field-label-bold">
                            <font>
                                <Font name="System Bold" size="13"/>
                            </font>
                        </Label>
                        <ComboBox fx:id="sportComboBox" promptText="Select sport type"
                                 styleClass="custom-combo-box" prefWidth="580"/>
                    </VBox>
    
                    <!-- Date and Time -->
                    <HBox spacing="15">
                        <VBox spacing="8" HBox.hgrow="ALWAYS">
                            <Label text="Date *" styleClass="field-label-bold">
                                <font>
                                    <Font name="System Bold" size="13"/>
                                </font>
                            </Label>
                            <DatePicker fx:id="datePicker" promptText="Select date"
                                       styleClass="custom-date-picker" prefWidth="280"/>
                        </VBox>
    
                        <VBox spacing="8" HBox.hgrow="ALWAYS">
                            <Label text="Time *" styleClass="field-label-bold">
                                <font>
                                    <Font name="System Bold" size="13"/>
                                </font>
                            </Label>
                            <ComboBox fx:id="timeComboBox" promptText="Select time"
                                      styleClass="custom-combo-box" prefWidth="280"/>
                        </VBox>
                    </HBox>
    
                    <!-- City -->
                    <VBox spacing="8">
                        <Label text="City *" styleClass="field-label-bold">
                            <font>
                                <Font name="System Bold" size="13"/>
                            </font>
                        </Label>
                        <ComboBox fx:id="cityComboBox" promptText="Select or type city name"
                                 styleClass="custom-combo-box" prefWidth="580" editable="true"/>
                    </VBox>
    
                    <!-- Participants -->
                    <VBox spacing="8">
                        <Label text="Additional Participants Needed *" styleClass="field-label-bold">
                            <font>
                                <Font name="System Bold" size="13"/>
                            </font>
                        </Label>
                        <Label text="(You are already counted as the first player)" styleClass="info-label"/>
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Spinner fx:id="participantsSpinner" prefWidth="150"
                                    styleClass="custom-spinner" editable="true"/>
                            <Label fx:id="participantsInfoLabel" text="Select a sport first"
                                  styleClass="info-label"/>
                        </HBox>
                    </VBox>

                    <!-- Match Summary (hidden initially) -->
                    <VBox fx:id="summaryBox" spacing="12" styleClass="summary-box"
                         visible="false" managed="false">
                        <Label text="Match Summary" styleClass="section-title">
                            <font>
                                <Font name="System Bold" size="15"/>
                            </font>
                        </Label>
    
                        <VBox spacing="8">
                            <HBox spacing="10">
                                <Label text="Sport:" styleClass="summary-label" prefWidth="100"/>
                                <Label fx:id="summarySport" text="-" styleClass="summary-value"/>
                            </HBox>
    
                            <HBox spacing="10">
                                <Label text="Date &amp; Time:" styleClass="summary-label" prefWidth="100"/>
                                <Label fx:id="summaryDateTime" text="-" styleClass="summary-value"/>
                            </HBox>
    
                            <HBox spacing="10">
                                <Label text="City:" styleClass="summary-label" prefWidth="100"/>
                                <Label fx:id="summaryCity" text="-" styleClass="summary-value"/>
                            </HBox>
    
                            <HBox spacing="10">
                                <Label text="Participants:" styleClass="summary-label" prefWidth="100"/>
                                <Label fx:id="summaryParticipants" text="-" styleClass="summary-value"/>
                            </HBox>
                        </VBox>
                    </VBox>
                    
                    <!-- Action Buttons -->
                    <HBox spacing="12" alignment="CENTER">
                        <padding>
                            <Insets top="10"/>
                        </padding>
                        <Button fx:id="searchFieldsButton" text="ðŸ” Search Available Fields"
                               onAction="#handleSearchFields" styleClass="primary-button"
                               prefWidth="220" prefHeight="40"/>
                        <Button fx:id="clearButton" text="Clear Form" onAction="#handleClear"
                               styleClass="secondary-button" prefWidth="150" prefHeight="40"/>
                    </HBox>
                </VBox>

            <!-- Error/Success Message -->
            <Label fx:id="messageLabel" wrapText="true" styleClass="message-label"/>

            <!-- Recap Section (hidden initially) -->
            <StackPane fx:id="recapBox" visible="false" managed="false">
                <VBox styleClass="recap-card">
                    <!-- Header -->
                    <VBox fx:id="recapHeader" styleClass="recap-header">
                        <ImageView fx:id="recapImage" fitHeight="80" fitWidth="80" preserveRatio="true" styleClass="recap-image"/>
                        <Label fx:id="recapSportLabel" text="SPORT NAME" styleClass="recap-title">
                            <VBox.margin>
                                <Insets top="10"/>
                            </VBox.margin>
                        </Label>
                    </VBox>

                    <!-- Body -->
                    <VBox spacing="0" styleClass="recap-body">
                        <GridPane vgap="5" hgap="20" alignment="CENTER">
                            <columnConstraints>
                                <ColumnConstraints halignment="RIGHT" minWidth="80"/>
                                <ColumnConstraints halignment="LEFT" minWidth="120"/>
                            </columnConstraints>
                            
                            <!-- Date Row -->
                            <VBox styleClass="recap-detail-row" GridPane.columnIndex="0" GridPane.rowIndex="0" GridPane.columnSpan="2">
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <Label text="DATE" styleClass="recap-label" prefWidth="60"/>
                                    <Label fx:id="recapDateLabel" text="-" styleClass="recap-value"/>
                                </HBox>
                            </VBox>
                            
                            <!-- Time Row -->
                            <VBox styleClass="recap-detail-row" GridPane.columnIndex="0" GridPane.rowIndex="1" GridPane.columnSpan="2">
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <Label text="TIME" styleClass="recap-label" prefWidth="60"/>
                                    <Label fx:id="recapTimeLabel" text="-" styleClass="recap-value"/>
                                </HBox>
                            </VBox>
                            
                            <!-- Location Row -->
                            <VBox styleClass="recap-detail-row" GridPane.columnIndex="0" GridPane.rowIndex="2" GridPane.columnSpan="2">
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <Label text="PLACE" styleClass="recap-label" prefWidth="60"/>
                                    <Label fx:id="recapCityLabel" text="-" styleClass="recap-value"/>
                                </HBox>
                            </VBox>
                            
                             <!-- Status Row -->
                            <VBox styleClass="recap-detail-row" GridPane.columnIndex="0" GridPane.rowIndex="3" GridPane.columnSpan="2" style="-fx-border-width: 0;">
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <Label text="STATUS" styleClass="recap-label" prefWidth="60"/>
                                    <Label fx:id="recapStatusLabel" text="CONFIRMED" styleClass="recap-value" style="-fx-text-fill: #10b981;"/>
                                </HBox>
                            </VBox>
                        </GridPane>
                    </VBox>

                    <!-- Footer -->
                    <VBox styleClass="recap-footer">
                        <Button fx:id="inviteButton" text="INVITE PLAYER" onAction="#handleInvite"
                                styleClass="primary-action-button" maxWidth="INFINITY"/>
                        <Button text="HOME" onAction="#handleHomeFromRecap"
                                styleClass="secondary-action-button" maxWidth="INFINITY"/>
                    </VBox>
                </VBox>
            </StackPane>
        </VBox>
    </ScrollPane>
</center>
</BorderPane>
